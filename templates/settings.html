{% extends "base.html" %}
{% block body %}
<div class="container">
  <div class="layout">
    <aside class="sidebar">
      <button class="btn small block" data-sidebar-toggle type="button">Toggle Sidebar</button>

      <h4>Navigation</h4>
      <a class="side-item" href="{{ url_for('dashboard') }}"><span class="label">üè† Overview</span><span class="badge">LIVE</span></a>
      <a class="side-item" href="{{ url_for('servers') }}"><span class="label">üñ• Servers</span><span class="badge">2</span></a>
      <a class="side-item" href="{{ url_for('reports') }}"><span class="label">üßæ Reports</span><span class="badge">LOG</span></a>
      <a class="side-item active" href="{{ url_for('settings') }}"><span class="label">‚öôÔ∏è Settings</span><span class="badge">CFG</span></a>

      <div class="sidebar-bottom">
        <a class="btn block primary" href="{{ url_for('guilds') }}">Switch Server</a>
        <a class="btn block danger" href="{{ url_for('logout') }}">Logout</a>
      </div>
    </aside>

    <main class="main">
      <div class="header-row">
        <div class="title">
          <h2>Settings</h2>
          <p>Server: <span class="kbd">{{ active_guild.name }}</span></p>
        </div>
      </div>

      <form method="post" action="{{ url_for('settings_save') }}">
        <div class="card">
          <h3>Core</h3>
          <div class="note">These settings are saved per guild in SQLite.</div>

          <div style="margin-top:12px;">
            <label class="kbd">Prefix</label>
            <input name="prefix" value="{{ settings.prefix }}" style="width:100%; margin-top:8px; padding:12px; border-radius:14px; border:1px solid var(--border); background:rgba(0,0,0,.18); color:var(--text);" />
          </div>

          <div style="margin-top:12px;">
            <label class="kbd">Mod Log Channel</label>
            <input name="mod_log_channel" value="{{ settings.mod_log_channel }}" placeholder="#mod-logs or ID"
              style="width:100%; margin-top:8px; padding:12px; border-radius:14px; border:1px solid var(--border); background:rgba(0,0,0,.18); color:var(--text);" />
          </div>

          <div style="margin-top:12px;">
            <label class="kbd">Welcome Message</label>
            <textarea name="welcome_message"
              style="width:100%; margin-top:8px; padding:12px; border-radius:14px; border:1px solid var(--border); background:rgba(0,0,0,.18); color:var(--text); min-height:100px;">{{ settings.welcome_message }}</textarea>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h3>Automation</h3>

          <div class="note">These are toggles only. Real bot actions come later.</div>

          <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px;">
            <label class="note">
              <input type="checkbox" name="automod_spam" {% if settings.automod_spam %}checked{% endif %}>
              Automod Spam
            </label>
            <label class="note">
              <input type="checkbox" name="automod_links" {% if settings.automod_links %}checked{% endif %}>
              Block Links
            </label>
            <label class="note">
              <input type="checkbox" name="automod_caps" {% if settings.automod_caps %}checked{% endif %}>
              Caps Filter
            </label>
            <label class="note">
              <input type="checkbox" name="anti_raid" {% if settings.anti_raid %}checked{% endif %}>
              Anti-Raid
            </label>
            <label class="note">
              <input type="checkbox" name="welcome_enabled" {% if settings.welcome_enabled %}checked{% endif %}>
              Welcome Enabled
            </label>
          </div>

          <div style="margin-top:12px;">
            <button class="btn primary" type="submit">Save Settings</button>
          </div>
        </div>

        <div class="note" style="margin-top:12px;">
          Render free tier can rebuild containers, which can reset SQLite. Prototype only.
          Next phase: Postgres + real bot backend.
        </div>
      </form>
    </main>
  </div>
</div>
{% endblock %}